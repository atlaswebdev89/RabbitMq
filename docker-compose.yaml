version: '3.1'

services:
    
    loadbalance:
        image: nginx
        container_name: nginx_loadbalance
        hostname: nginxhost
        ports:
            - "5672:5672"
        volumes:
          - ./nginx-config/nginx.conf:/etc/nginx/nginx.conf
        networks:
          - public

    rabbit1:
        image: rabbitmq:management
        container_name: rabbit1
        hostname: rabbit1
        ports:
            - "15672:15672"
        environment:
            - RABBITMQ_ERLANG_COOKIE='mysecret'
        networks:
          - public
    rabbit2:
        image: rabbitmq:management
        container_name: rabbit2
        hostname: rabbit2
        ports:
            - "15673:15672"
            - "5673:5672"
        environment:
            - RABBITMQ_ERLANG_COOKIE='mysecret'
        networks:
          - public
    rabbit3:
        image: rabbitmq:management
        container_name: rabbit3
        hostname: rabbit3
        ports:
            - "15674:15672"
            - "5674:5672"
        environment:
            - RABBITMQ_ERLANG_COOKIE='mysecret'
        networks:
          - public
          
networks:
  public:
    driver: bridge